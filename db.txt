-- 1. Table des Administrateurs
CREATE TABLE administrateurs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR NOT NULL UNIQUE,
    pseudo VARCHAR NOT NULL UNIQUE,
    cree_le TIMESTAMP DEFAULT NOW()
);

-- 2. Table des Projets
CREATE TABLE projets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    nom VARCHAR NOT NULL UNIQUE,
    origines_autorisees VARCHAR NOT NULL,
    publishable_key VARCHAR NOT NULL UNIQUE,
    secret_key_hash VARCHAR NOT NULL UNIQUE,
    est_actif BOOLEAN DEFAULT TRUE,
    administrateur_id UUID NOT NULL REFERENCES administrateurs(id) ON DELETE CASCADE,
    cree_le TIMESTAMP DEFAULT NOW()
);

-- 3. Table des Utilisateurs
CREATE TABLE utilisateurs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR NOT NULL UNIQUE,
    cree_le TIMESTAMP DEFAULT NOW()
);

-- 4. Table des Utilisateurs Appartiennent Ã  des Projets
CREATE TABLE utilisateurs_projets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    derniere_connexion TIMESTAMP,
    utilisateur_id UUID NOT NULL REFERENCES utilisateurs(id) ON DELETE CASCADE,    
    projet_id UUID NOT NULL REFERENCES projets(id) ON DELETE CASCADE,
    cree_le TIMESTAMP DEFAULT NOW()
);
